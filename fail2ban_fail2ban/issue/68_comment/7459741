IssueComment {issueCommentUpdatedAt = GithubDate {fromGithubDate = 2012-08-02 16:03:43 UTC}, issueCommentUser = GithubUser {githubOwnerAvatarUrl = "https://secure.gravatar.com/avatar/68d806db1b31ae8e9464b583e2aa29c6?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", githubOwnerLogin = "afragen", githubOwnerUrl = "https://api.github.com/users/afragen", githubOwnerId = 1296790, githubOwnerGravatarId = "68d806db1b31ae8e9464b583e2aa29c6"}, issueCommentUrl = "https://api.github.com/repos/fail2ban/fail2ban/issues/comments/7459741", issueCommentCreatedAt = GithubDate {fromGithubDate = 2012-08-02 16:03:43 UTC}, issueCommentBody = "The argument taken by the ipfw delete is rulenum. actionunban = ipfw delete `ipfw list | grep -i <ip> | awk '{print $1;}'` grabs the rulenum, which is why when no rulenum is set and ipfw automatically adds the same rulenum, every unban causes all the rules to delete.\n\nFrom ipfw man page\n\n rule_number\n             Each rule is associated with a rule_number in the range 1..65535, with the latter reserved for the\n             default rule.  Rules are checked sequentially by rule number.  Multiple rules can have the same num-\n             ber, in which case they are checked (and listed) according to the order in which they have been\n             added.  If a rule is entered without specifying a number, the kernel will assign one in such a way\n             that the rule becomes the last one before the default rule.  Automatic rule numbers are assigned by\n             incrementing the last non-default rule number by the value of the sysctl variable\n             net.inet.ip.fw.autoinc_step which defaults to 100.  If this is not possible (e.g. because we would go\n             beyond the maximum allowed rule number), the number of the last non-default value is used instead.\n", issueCommentId = 7459741}