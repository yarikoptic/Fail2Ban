IssueComment {issueCommentUpdatedAt = GithubDate {fromGithubDate = 2012-08-15 06:21:14 UTC}, issueCommentUser = GithubUser {githubOwnerAvatarUrl = "https://secure.gravatar.com/avatar/e782561a98d0e131cbd4980f62853597?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", githubOwnerLogin = "mikeg-de", githubOwnerUrl = "https://api.github.com/users/mikeg-de", githubOwnerId = 604842, githubOwnerGravatarId = "e782561a98d0e131cbd4980f62853597"}, issueCommentUrl = "https://api.github.com/repos/fail2ban/fail2ban/issues/comments/7749153", issueCommentCreatedAt = GithubDate {fromGithubDate = 2012-08-15 06:20:41 UTC}, issueCommentBody = "Hi Yarikoptic,\n\nhere's the Fail2Ban log with debug mode:\n\n2012-08-15 07:39:29,278 fail2ban.actions.action: DEBUG  iptables -n -L INPUT | grep -q fail2ban-SSH\n2012-08-15 07:39:29,304 fail2ban.actions.action: DEBUG  iptables -n -L INPUT | grep -q fail2ban-SSH returned successfully\n2012-08-15 07:39:29,305 fail2ban.actions.action: DEBUG  iptables -D fail2ban-SSH -s 221.174.50.140 -j DROP\n2012-08-15 07:39:29,309 fail2ban.actions.action: DEBUG  iptables -D fail2ban-SSH -s 221.174.50.140 -j DROP returned successfully\n2012-08-15 07:39:29,309 fail2ban.actions.action: DEBUG  Nothing to do\n2012-08-15 07:39:46,783 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:39:46,785 fail2ban.filter : DEBUG  Found 221.174.50.140\n2012-08-15 07:39:46,785 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n2012-08-15 07:40:01,785 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:40:01,786 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n2012-08-15 07:43:06,822 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:43:06,823 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n2012-08-15 07:44:55,829 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:44:55,830 fail2ban.filter : DEBUG  Found 221.174.50.140\n2012-08-15 07:44:55,831 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n2012-08-15 07:45:42,844 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:45:42,845 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n2012-08-15 07:45:43,845 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:45:43,846 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n2012-08-15 07:50:01,870 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:50:01,870 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n2012-08-15 07:50:03,871 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:50:03,872 fail2ban.filter : DEBUG  Found 221.174.50.140\n2012-08-15 07:50:03,872 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n2012-08-15 07:50:04,374 fail2ban.actions: WARNING [ssh-iptables] Ban 221.174.50.140\n2012-08-15 07:50:04,374 fail2ban.actions.action: DEBUG  iptables -n -L INPUT | grep -q fail2ban-SSH\n2012-08-15 07:50:04,400 fail2ban.actions.action: DEBUG  iptables -n -L INPUT | grep -q fail2ban-SSH returned successfully\n2012-08-15 07:50:04,401 fail2ban.actions.action: DEBUG  iptables -I fail2ban-SSH 1 -s 221.174.50.140 -j DROP\n2012-08-15 07:50:04,410 fail2ban.actions.action: DEBUG  iptables -I fail2ban-SSH 1 -s 221.174.50.140 -j DROP returned successfully\n2012-08-15 07:50:04,411 fail2ban.actions.action: DEBUG  \n2012-08-15 07:50:04,418 fail2ban.actions.action: DEBUG   returned successfully\n2012-08-15 07:50:04,418 fail2ban.actions.action: DEBUG  printf %b \"Subject: [Fail2Ban] SSH: banned 221.174.50.140\nFrom: Fail2Ban <icinga@YXZ.net>\nTo: support@YXZ.com\\n\nHi,\\n\nThe IP 221.174.50.140 has just been banned by Fail2Ban after\n3 attempts against SSH.\\n\\n\nHere are more information about 221.174.50.140:\\n\n`/usr/bin/whois 221.174.50.140`\\n\nRegards,\\n\nFail2Ban\" | /usr/sbin/sendmail -f icinga@YXZ.net support@YXZ.com\n2012-08-15 07:50:06,541 fail2ban.actions.action: DEBUG  printf %b \"Subject: [Fail2Ban] SSH: banned 221.174.50.140\nFrom: Fail2Ban <icinga@XYZ.net>\nTo: support@YXZ.com\\n\nHi,\\n\nThe IP 221.174.50.140 has just been banned by Fail2Ban after\n3 attempts against SSH.\\n\\n\nHere are more information about 221.174.50.140:\\n\n`/usr/bin/whois 221.174.50.140`\\n\nRegards,\\n\nFail2Ban\" | /usr/sbin/sendmail -f icinga@YXZ.net support@YXZ.com returned successfully\n2012-08-15 07:55:54,946 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:55:54,948 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n2012-08-15 07:56:16,948 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:56:16,949 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n2012-08-15 07:57:06,243 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:57:06,649 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n2012-08-15 07:57:55,033 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:57:55,036 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n2012-08-15 07:58:36,789 fail2ban.filter : DEBUG  /var/log/messages has been modified\n2012-08-15 07:58:36,790 fail2ban.filter.datedetector: DEBUG  Sorting the template list\n\nI've portsentry running as well which causes some IPs inserted a couple of times in the hosts.deny but that shouldn't has anything in common with Fail2Ban. In my jail.conf I've two filters acitve:\n\n[ssh-iptables]\nenabled = true\nfilter\t\t=\tsshd\naction\t=\tiptables[name=SSH, port=ssh, protocol=tcp]\n\t\t\tsendmail-whois[name=SSH, dest=support@XYZ.com, sender=icinga@XYZ.net]\nlogpath\t=\t/var/log/messages\nmaxretry\t=\t3\n\n\n[ssh-tcpwrapper]\nenabled  \t\t=\ttrue\nfilter   \t\t=\tsshd\naction   \t\t=\thostsdeny\n\t\t\t\tsendmail-whois[name=SSH, dest=support@XYZ.com]\nignoreregex\t=\tfor myuser from\nlogpath  \t\t=\t/var/log/sshd.log\n\nThanks your support and Fail2Ban\nMike", issueCommentId = 7749153}