Issue {issueClosedAt = Nothing, issueUpdatedAt = GithubDate {fromGithubDate = 2013-04-09 15:35:17 UTC}, issueHtmlUrl = "https://github.com/fail2ban/fail2ban/issues/167", issueClosedBy = Nothing, issueLabels = [], issueNumber = 167, issueAssignee = Nothing, issueUser = GithubUser {githubOwnerAvatarUrl = "https://secure.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", githubOwnerLogin = "ncollignon", githubOwnerUrl = "https://api.github.com/users/ncollignon", githubOwnerId = 4039227, githubOwnerGravatarId = "d41d8cd98f00b204e9800998ecf8427e"}, issueTitle = "FD_CLOEXEC bug fixes (filters) + support (actions). Avoid sockets descriptors leak.", issuePullRequest = PullRequestReference {pullRequestReferenceHtmlUrl = Just "https://github.com/fail2ban/fail2ban/pull/167", pullRequestReferencePatchUrl = Just "https://github.com/fail2ban/fail2ban/pull/167.patch", pullRequestReferenceDiffUrl = Just "https://github.com/fail2ban/fail2ban/pull/167.diff"}, issueUrl = "https://api.github.com/repos/fail2ban/fail2ban/issues/167", issueCreatedAt = GithubDate {fromGithubDate = 2013-04-09 15:09:20 UTC}, issueBody = "* 001-fail2ban-server-socket-close-on-exec-no-leak.diff\r\n\r\nAdd code that marks server and client sockets with FD_CLOEXEC flags.\r\nAvoid leaking file descriptors to processes spawned when handling\r\nfail2ban actions (ex: iptables).\r\n\r\nUnix sockets managed by fail2ban-server don't need to be passed to any\r\nchild process. Fail2ban already uses the FD_CLOEXEC flags in the filter\r\ncode.\r\n\r\nThis patch also avoids giving iptables access to fail2ban UNIX socket in\r\na SELinux environment (A sane SELinux policy should trigger an audit\r\nevent because \"iptables\" will be given read/write access to the fail2ban\r\ncontrol socket).\r\n\r\nSome random references related to this bug:\r\n http://sourceforge.net/tracker/?func=detail&atid=689044&aid=2086568&group_id=121032\r\n http://www.redhat.com/archives/fedora-selinux-list/2009-June/msg00124.html\r\n http://forums.fedoraforum.org/showthread.php?t=234230\r\n\r\n * 002-fail2ban-filters-close-on-exec-typo-fix.diff\r\n\r\nThere is a typo in the fail2ban server/filter.py source code. The\r\nFD_CLOEXEC is correctly set but additional *random* flags are also set.\r\nIt has no side-effect as long as the fd doesn't match a valid flag :)\r\n\"fcntl.fcntl(fd, fcntl.F_SETFD, fd | fcntl.FD_CLOEXEC)\" <== the 3rd\r\nparameter should be flags, not a file descriptor.\r\n\r\n * 003-fail2ban-gamin-socket-close-on-exec-no-leak.diff\r\n\r\nAdd code that marks the Gamin monitor file descriptor with FD_CLOEXEC\r\nflags. Avoid leaking file descriptors to processes spawned when handling\r\nfail2ban actions (ex: iptables).\r\n\r\n---\r\n\r\nFile descriptors in action process before patches:\r\ndr-x------ 2 root root  0 .\r\ndr-xr-xr-x 8 root root  0 ..\r\nlr-x------ 1 root root 64 0 -> /dev/null        <== OK\r\nl-wx------ 1 root root 64 1 -> /tmp/test.log    <== used by test action\r\nlrwx------ 1 root root 64 2 -> /dev/null        <== OK\r\nlrwx------ 1 root root 64 3 -> socket:[116361]  <== NOK (fail2ban.sock leak)\r\nlr-x------ 1 root root 64 4 -> /proc/20090/fd   <== used by test action\r\nl-wx------ 1 root root 64 5 -> /var/log/fail2ban.log <== OK\r\nlrwx------ 1 root root 64 6 -> socket:[115608]  <== NOK (gamin sock leak)\r\n\r\nFile descriptors in action process after patches:\r\ndr-x------ 2 root root  0 .\r\ndr-xr-xr-x 8 root root  0 ..\r\nlr-x------ 1 root root 64 0 -> /dev/null        <== OK\r\nl-wx------ 1 root root 64 1 -> /tmp/test.log    <== used by test action\r\nlrwx------ 1 root root 64 2 -> /dev/null        <== OK\r\nlr-x------ 1 root root 64 3 -> /proc/18284/fd   <== used by test action\r\nl-wx------ 1 root root 64 5 -> /var/log/fail2ban.log <== OK", issueState = "open", issueId = 12975818, issueComments = 2, issueMilestone = Nothing}