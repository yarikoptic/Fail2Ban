IssueComment {issueCommentUpdatedAt = GithubDate {fromGithubDate = 2012-12-11 21:58:26 UTC}, issueCommentUser = GithubUser {githubOwnerAvatarUrl = "https://secure.gravatar.com/avatar/004e831787204c4a5be80c5f55227764?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png", githubOwnerLogin = "grooverdan", githubOwnerUrl = "https://api.github.com/users/grooverdan", githubOwnerId = 462287, githubOwnerGravatarId = "004e831787204c4a5be80c5f55227764"}, issueCommentUrl = "https://api.github.com/repos/fail2ban/fail2ban/issues/comments/11266315", issueCommentCreatedAt = GithubDate {fromGithubDate = 2012-12-11 21:58:26 UTC}, issueCommentBody = "> interesting -- never used ipsets yet.\r\n\r\n> could you give a practical summary of advantages over a separate chain? I guess there should be performance advantage, but how much?\r\n\r\nFor large ban lists its a hash based lookup of IPs rather than a list iteration of rules. I haven't quantified it yet either.\r\n\r\n> why bother to introduce ipsets' managed bantime (in proto6) since actiounban is defined anyways\r\n\r\na) the actionunban was defined so the fail2ban-client set unban ip {} would work. Apart from that its not needed.\r\nb) if more actions that don't require fail2ban to manage the unbantime come about there could be something added to the config to leave them unmanaged and save on memory within fail2ban.\r\n\r\nnote: The timeout was only supported in protocol 6 of ipset.\r\n\r\n> (might lead to spurious errors while running unban if ban already timedout, isn't it?)?\r\n\r\nThe -exists option on del (and add) ignores already existing items and I've tested this so there's no spurious errors (just a few unnecessary calls).\r\n\r\n> would it work for both ipv4 and ipv6 without any changes?\r\n\r\nFor ipv6 a  'family inet6' is needed on the create set. I've only partially looked through the IPv6 work in progress but am happy to provide tested examples. About 1/2 my employers and client's servers already have IPv6 and I would definitely like it working there. There is also a 'netmask' option on each ipset that could be useful with IPv6 blocking /48s at a time perhaps (I need to check the standard allocation spec again).\r\n\r\n> could you provide exemplar jail definitions (probably for sshd filter)?\r\n\r\nthe jail.local I used in testing was:\r\n\r\n[ssh]\r\n\r\nfilter=sshd\r\naction=iptables-ipset-proto4\r\nlogpath = /var/log/auth.log\r\n\r\nand for proto6\r\n[ssh]\r\n\r\nfilter=sshd\r\naction=iptables-ipset-proto6[name=SSH, port=ssh, protocol=tcp]\r\nlogpath = /var/log/auth.log\r\n", issueCommentId = 11266315}